{% extends "base.html" %}

{% block title %}Illinois Salaries Database{% endblock %}

{% block extra_css %}
<link href="{{ static('css/jquery-ui.min.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}

<div class="row">
  <div class="col-md-10 offset-md-1">
    <div class="row">
      <div class="jumbotron bg-light">
        <div class="row">
          <div class="col-md">
              <h1>Illinois Salaries Database</h1>

              <p class="lead">The <strong>most comprehensive</strong> place to find out how government employees are paid, statewide.</p>

              <p>With the BGA's searchable database of public payrolls across Illinois, you can easily access information relating to the spending of state, county, and local units of government.</p>
          </div>
        </div>

        <form id="entity-form">
          <div class="row">
            <div class="col-md mb-3">
              <strong class="mr-3">I'm looking for a:</strong>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="unit-check" value="unit" checked>
                <label class="form-check-label" for="unit-check"><i class="fas fa-building"></i> Unit</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="department-check" value="department">
                <label class="form-check-label" for="department-check"><i class="far fa-building"></i> Department</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="person-check" value="person" checked>
                <label class="form-check-label" for="person-check"><i class="far fa-address-card"></i> Person</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md">
              <div class="input-group">
                <input type="text" id="entity-lookup" class="form-control form-control-lg" placeholder="Cook County" />
                <div class="input-group-append">
                  <button type="submit" class="btn btn-primary btn-lg" id="submit-button">
                    <i class="fas fa-search"></i> Search
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md collapse mt-3" id="name-warning">
                <div class="alert alert-danger" role="alert">
                  <i class="fas fa-exclamation-circle"></i> Please enter the name of a <strong>Unit, Department, or Person</strong> you'd like to look up.
                </div>
            </div>
          </div>
        </form>
      </div><!-- .jumbotron -->
    </div>

    <div class="row mt-4">
      <div class="col-md">
        <h3>What's inside?</h3>

        <p>The <strong>Illinois Salary Database</strong> contains <strong>{{ salary_count }}</strong> records of base pay for government employees in <strong>{{ department_count }}</strong> <span class="text-primary font-weight-bold"><i class="far fa-building"></i> Departments</span> across <strong>{{ unit_count }}</strong> <span class="text-primary font-weight-bold"><i class="fas fa-building"></i> Units</span> in the state of Illinois.</p>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md">
        <h5>Distribution of public salaries in 2017</h5>
      </div>
    </div>

    <div class="row">
      <div class="col-md">
        <div id="employee-distribution-chart"></div>
      </div>
    </div>

    <div class="row">
      <div class="col-md">
        <p>Each year, the BGA gathers new data from hundreds of public agencies. Like what you see?</p>

        <div class="text-center">
          <a class="btn btn-lg btn-primary" href="https://bettergov.salsalabs.org/donationform/index.html">
            <i class="fas fa-handshake"></i> Donate to the BGA
          </a>
        </div>
      </div>
    </div>

    <div class="row mt-5">
      <div class="col-md">
        <h3>Inspiration</h3>
      </div>
    </div>

    <div class="row mt-2">
      <div class="col-md-4">
        <div class="card">
          <div class="card-body text-center">
            <h4><i class="fas fa-dollar-sign"></i></h4>
            <h5>Highest paid people in Illinois</h5><br />
            <a href="/search/?entity_type=person&employer={{ illinois_slug }}" class="btn btn-primary"><i class="fas fa-search"></i> Explore</a>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body text-center">
            <h4><i class="fas fa-users"></i></h4>
            <h5 class="text-center">Highest spending departments in Chicago</h5><br />
            <a href="/search/?entity_type=department&parent={{ chicago_slug }}" class="btn btn-primary"><i class="fas fa-search"></i> Explore</a>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body text-center">
            <h4><i class="fas fa-gavel"></i></h4>
            <h5>Highest spending police departments</h5><br />
            <a href='/search/?entity_type=department&universe="Police+Department"' class="btn btn-primary"><i class="fas fa-search"></i> Explore</a>
          </div>
        </div>
      </div>
    </div>

    <div class="clearfix"></div>

    <div class="row mt-5">
      <div class="col-md">
        <h3>Need help?</h3>
        <p>Contact our data coordinator.</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block modals %}
<div class="modal" tabindex="-1" role="dialog" id="emailModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <div id="fbf1d375-61ec-433d-943f-8d4e6e3ae35a"><script type="text/javascript" src="https://default.salsalabs.org/api/widget/template/82a20ce0-6591-4a90-a77d-d73599ec9b43/?tId=fbf1d375-61ec-433d-943f-8d4e6e3ae35a" ></script></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script type="text/javascript" src="{{ static('js/lib/jquery-ui.min.js') }}"></script>
<script type="text/javascript" src="{{ static('js/entity_auto_complete.js') }}"></script>
<script src="{{ static('js/chart_helper.js') }}"></script>

<script type="text/javascript">
  // Style the charts a little differently on the homepage.
  Highcharts.setOptions({
    chart: {
      backgroundColor: '#f7f7f7',
    },
    plotOptions: {
      series: {
        borderColor: '#f7f7f7',
      }
    }
  });

  ChartHelper.make_salary_chart({{ salary_json|safe }}, 'employee');

  $('#submit-button').click(function submitSearch(e) {
      e.preventDefault();

      var url;

      var entity_types = [];

      $('.entity-type-check').filter('input:checked').each(function entityTypes() {
        entity_types.push($(this).val());
      })

      var params = {
        'name': $('#entity-lookup').val(),
        'entity_type': entity_types.join(','),
      }


      if ( $('#entity-lookup').val() ) {
        url = '/search/?' + $.param(params);
        window.location = url;
      } else {
        $('#name-warning').collapse('show');
      }
  });

  $('#emailModal').modal();
</script>
{% endblock %}