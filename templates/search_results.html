{% extends "base.html" %}

{% block title %}
    Search results
{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">All</a></li>
        <li class="breadcrumb-item">Search</li>
    </ol>
</nav>

<div class="card">
    <div class="card-body">
        <h2>Search results</h2>

        <div class="row mb-3">
            <div class="col">
                Filter by: <a class="badge {% if 'entity_type' in request.GET and request.GET['entity_type'] == 'person' %}badge-primary{% else %}badge-light{% endif %}" href="{{ request.path }}?entity_type=person&{{ request|query_transform(drop_keys=['entity_type']) }}"><i class="far fa-address-card"></i> Person</a>
                <a class="badge {% if 'entity_type' in request.GET and request.GET['entity_type'] == 'employer' %}badge-primary{% else %}badge-light{% endif %}" href="{{ request.path }}?entity_type=employer&{{ request|query_transform(drop_keys=['entity_type']) }}"><i class="fas fa-building"></i> Unit</a>
                <a class="badge {% if 'entity_type' in request.GET and request.GET['entity_type'] == 'employer' %}badge-primary{% else %}badge-light{% endif %}" href="{{ request.path }}?entity_type=employer&{{ request|query_transform(drop_keys=['entity_type']) }}"><i class="far fa-building"></i> Department</a>
                <a class="badge {% if 'entity_type' not in request.GET %}badge-primary{% else %}badge-light{% endif %}" href="{{ request.path }}?{{ request|query_transform(drop_keys=['entity_type']) }}"><i class="fas fa-globe"></i> All</a>
            </div>
        </div>

        <table class="table table-striped table-hover">
            <thead class="bg-warning">
                <th span="col">Name</th>
            </thead>
            <tbody>
                {% for result in results %}
                    {% set entity_type = result.__class__.__name__|lower %}
                    <tr>
                        <td>
                            <a href="/{{ entity_type }}/{{ result.slug }}/">{{ result }}</a>
                            <span class="badge badge-light">
                                {% if entity_type == 'person' %}
                                    <i class="far fa-address-card"></i> Person
                                {% else %}
                                    {% if result.is_department %}
                                        <i class="far fa-building"></i> Department
                                    {% else %}
                                        <i class="fas fa-building"></i> Unit
                                    {% endif %}
                                {% endif %}
                            </span>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        {% include 'partials/pagination.html' %}
    </div>
</div>
{% endblock %}
